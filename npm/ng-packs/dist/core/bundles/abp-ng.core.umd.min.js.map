{"version":3,"sources":["../../../node_modules/tslib/tslib.es6.js","ng://@abp/ng.core/lib/actions/config.actions.ts","ng://@abp/ng.core/lib/actions/loader.actions.ts","ng://@abp/ng.core/lib/actions/profile.actions.ts","ng://@abp/ng.core/lib/actions/rest.actions.ts","ng://@abp/ng.core/lib/actions/session.actions.ts","ng://@abp/ng.core/lib/services/rest.service.ts","ng://@abp/ng.core/lib/services/profile.service.ts","ng://@abp/ng.core/lib/states/profile.state.ts","ng://@abp/ng.core/lib/services/application-configuration.service.ts","ng://@abp/ng.core/lib/states/session.state.ts","ng://@abp/ng.core/lib/utils/route-utils.ts","ng://@abp/ng.core/lib/states/config.state.ts","ng://@abp/ng.core/lib/utils/generator-utils.ts","ng://@abp/ng.core/lib/utils/initial-utils.ts","ng://@abp/ng.core/lib/utils/rxjs-utils.ts","ng://@abp/ng.core/lib/components/dynamic-layout.component.ts","ng://@abp/ng.core/lib/components/router-outlet.component.ts","ng://@abp/ng.core/lib/directives/ellipsis.directive.ts","ng://@abp/ng.core/lib/directives/permission.directive.ts","ng://@abp/ng.core/lib/directives/visibility.directive.ts","ng://@abp/ng.core/lib/guards/auth.guard.ts","ng://@abp/ng.core/lib/guards/permission.guard.ts","ng://@abp/ng.core/lib/interceptors/api.interceptor.ts","ng://@abp/ng.core/lib/models/rest.ts","ng://@abp/ng.core/lib/plugins/config.plugin.ts","ng://@abp/ng.core/lib/services/config.service.ts","ng://@abp/ng.core/lib/services/lazy-load.service.ts","ng://@abp/ng.core/lib/services/localization.service.ts","ng://@abp/ng.core/lib/tokens/common.token.ts","ng://@abp/ng.core/lib/pipes/localization.pipe.ts","ng://@abp/ng.core/lib/core.module.ts"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__decorate","decorators","target","key","desc","d","c","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__metadata","metadataKey","metadataValue","metadata","__read","o","m","Symbol","iterator","ar","next","done","push","value","error","__spread","concat","PatchRouteByName","name","newValue","type","ConfigGetAppConfiguration","LoaderStart","payload","LoaderStop","ProfileGet","ProfileUpdate","ProfileChangePassword","RestOccurError","SessionSetLanguage","RestService","http","store","handleError","err","dispatch","console","NEVER","request","config","api","_this","_a","observe","throwErr","url","selectSnapshot","ConfigState","getApiUrl","method","options","pipe","take","catchError","throwError","Injectable","args","providedIn","HttpClient","Store","ProfileService","rest","get","update","body","changePassword","ProfileState","profileService","getProfile","profile","profileGet","patchState","tap","profileUpdate","_b","_","tslib_1.__decorate","Action","Selector","State","defaults","ApplicationConfigurationService","getConfiguration","SessionState","getLanguage","language","sessionSetLanguage","organizeRoutes","routes","wrappers","parentNameArr","parentName","filter","route","children","filteredRoutes","sortRoutes","setChildRoute","map","foundedChildren","parent","path","sort","a","b","order","appConfigurationService","getAll","state","getOne","createSelector","ConfigState_1","getDeep","keys","split","Array","isArray","Error","reduce","acc","val","environment","apis","getSetting","snq","setting","values","getGrantedPolicy","condition","replace","selector","getPolicy","auth","grantedPolicies","forEach","eval","getCopy","interpolateParams","_i","defaultResourceName","localization","copy","param","index","addData","configuration","switchMap","of","patchRoute","getState","findIndex","patchRouteDeep","parentUrl","child","uuid","Math","random","toString","getInitialData","injector","toPromise","isFunction","takeUntilDestroy","componentInstance","destroyMethodName","source","originalDestroy","constructor","Subject","complete","takeUntil","DynamicLayoutComponent","router","events","subscribe","event","NavigationEnd","segments","parseUrl","root","primary","layouts","requirements","layout_1","findLayout","layout","l","find","toLowerCase","ngOnDestroy","Component","template","Router","Select","Observable","wrapper","RouterOutletComponent","EllipsisDirective","cdRef","elRef","enabled","witdh","undefined","ngAfterContentInit","setTimeout","title","innerText","detectChanges","Directive","ChangeDetectorRef","ElementRef","Input","HostBinding","PermissionDirective","renderer","ngOnInit","select","isGranted","removeChild","parentElement","nativeElement","Optional","Renderer2","VisibilityDirective","completed$","ngAfterViewInit","observer","MutationObserver","mutations","mutation","from","childNodes","node","HTMLElement","disconnect","focusedElement","childList","AuthGuard","oauthService","canActivate","hasValidAccessToken","Navigate","redirectUrl","OAuthService","PermissionGuard","resource","data","ApiInterceptor","oAuthService","intercept","headers","token","getAccessToken","has","lang","handle","clone","setHeaders","finalize","Rest","NGXS_CONFIG_PLUGIN_OPTIONS","InjectionToken","ConfigPlugin","initialized","matches","actionMatcher","InitState","UpdateState","transformRoutes","setValue","Inject","abpRoutes","transformed","component","loadChildren","abpPackage","abp","setUrls","ConfigService","LazyLoadService","loadedLibraries","load","content","targetQuery","position","library","slice","lastIndexOf","asObservable","ReplaySubject","document","createElement","src","text","rel","href","textContent","onload","querySelector","insertAdjacentElement","LocalizationService","instant","environmentFactory","configFactory","ENVIRONMENT","CONFIG","LocalizationPipe","transform","distinctUntilChanged","Pipe","pure","CoreModule","forRoot","ngModule","providers","provide","NGXS_PLUGINS","useClass","multi","useValue","HTTP_INTERCEPTORS","APP_INITIALIZER","deps","Injector","useFactory","NgModule","imports","NgxsModule","forFeature","NgxsStoragePluginModule","NgxsRouterPluginModule","CommonModule","HttpClientModule","FormsModule","ReactiveFormsModule","RouterModule","declarations","exports","entryComponents"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import { ABP } from '../models';\n\nexport class PatchRouteByName {\n  static readonly type = '[Config] Patch Route By Name';\n  constructor(public name: string, public newValue: Partial<ABP.Route>) {}\n}\n\nexport class ConfigGetAppConfiguration {\n  static readonly type = '[Config] Get App Configuration';\n}\n","import { HttpRequest } from '@angular/common/http';\n\nexport class LoaderStart {\n  static readonly type = '[Loader] Start';\n  constructor(public payload: HttpRequest<any>) {}\n}\n\nexport class LoaderStop {\n  static readonly type = '[Loader] Stop';\n  constructor(public payload: HttpRequest<any>) {}\n}\n","import { Profile } from '../models';\n\nexport class ProfileGet {\n  static readonly type = '[Profile] Get';\n}\n\nexport class ProfileUpdate {\n  static readonly type = '[Profile] Update';\n  constructor(public payload: Profile.Response) {}\n}\n\nexport class ProfileChangePassword {\n  static readonly type = '[Profile] Change Password';\n  constructor(public payload: Profile.ChangePasswordRequest) {}\n}\n","import { HttpErrorResponse } from '@angular/common/http';\n\nexport class RestOccurError {\n  static readonly type = '[Rest] Error';\n  constructor(public payload: HttpErrorResponse | any) {}\n}\n","export class SessionSetLanguage {\n  static readonly type = '[Session] Set Language';\n  constructor(public payload: string) {}\n}\n","import { HttpClient, HttpRequest } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Store } from '@ngxs/store';\nimport { NEVER, Observable, throwError } from 'rxjs';\nimport { catchError, take } from 'rxjs/operators';\nimport { Rest } from '../models/rest';\nimport { ConfigState } from '../states';\nimport { RestOccurError } from '../actions';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class RestService {\n  constructor(private http: HttpClient, private store: Store) {}\n\n  handleError(err: any): Observable<any> {\n    this.store.dispatch(new RestOccurError(err));\n    console.error(err);\n    return NEVER;\n  }\n\n  request<T, R>(request: HttpRequest<T> | Rest.Request<T>, config: Rest.Config = {}, api?: string): Observable<R> {\n    const { observe = Rest.Observe.Body, throwErr } = config;\n    const url = api || this.store.selectSnapshot(ConfigState.getApiUrl()) + request.url;\n    const { method, ...options } = request;\n    return this.http.request<T>(method, url, { observe, ...options } as any).pipe(\n      observe === Rest.Observe.Body ? take(1) : null,\n      catchError(err => {\n        if (throwErr) {\n          return throwError(err);\n        }\n\n        return this.handleError(err);\n      }),\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { RestService } from './rest.service';\nimport { Profile, Rest } from '../models';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ProfileService {\n  constructor(private rest: RestService) {}\n\n  get(): Observable<Profile.Response> {\n    const request: Rest.Request<null> = {\n      method: 'GET',\n      url: '/api/identity/my-profile',\n    };\n\n    return this.rest.request<null, Profile.Response>(request);\n  }\n\n  update(body: Profile.Response): Observable<Profile.Response> {\n    const request: Rest.Request<Profile.Response> = {\n      method: 'PUT',\n      url: '/api/identity/my-profile',\n      body,\n    };\n\n    return this.rest.request<Profile.Response, Profile.Response>(request);\n  }\n\n  changePassword(body: Profile.ChangePasswordRequest): Observable<null> {\n    const request: Rest.Request<Profile.ChangePasswordRequest> = {\n      method: 'POST',\n      url: '/api/identity/my-profile/changePassword',\n      body,\n    };\n\n    return this.rest.request<Profile.ChangePasswordRequest, null>(request);\n  }\n}\n","import { State, Action, StateContext, Selector } from '@ngxs/store';\nimport { ProfileGet, ProfileChangePassword, ProfileUpdate } from '../actions/profile.actions';\nimport { Profile } from '../models/profile';\nimport { ProfileService } from '../services/profile.service';\nimport { tap } from 'rxjs/operators';\n\n@State<Profile.State>({\n  name: 'ProfileState',\n  defaults: {} as Profile.State,\n})\nexport class ProfileState {\n  @Selector()\n  static getProfile({ profile }: Profile.State): Profile.Response {\n    return profile;\n  }\n\n  constructor(private profileService: ProfileService) {}\n\n  @Action(ProfileGet)\n  profileGet({ patchState }: StateContext<Profile.State>) {\n    return this.profileService.get().pipe(\n      tap(profile =>\n        patchState({\n          profile,\n        }),\n      ),\n    );\n  }\n\n  @Action(ProfileUpdate)\n  profileUpdate({ patchState }: StateContext<Profile.State>, { payload }: ProfileUpdate) {\n    return this.profileService.update(payload).pipe(\n      tap(profile =>\n        patchState({\n          profile,\n        }),\n      ),\n    );\n  }\n\n  @Action(ProfileChangePassword)\n  changePassword(_, { payload }: ProfileChangePassword) {\n    return this.profileService.changePassword(payload);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { ApplicationConfiguration, Rest } from '../models';\nimport { RestService } from './rest.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ApplicationConfigurationService {\n  constructor(private rest: RestService) {}\n\n  getConfiguration(): Observable<ApplicationConfiguration.Response> {\n    const request: Rest.Request<null> = {\n      method: 'GET',\n      url: '/api/abp/application-configuration',\n    };\n\n    return this.rest.request<null, ApplicationConfiguration.Response>(request);\n  }\n}\n","import { State, Action, StateContext, Selector } from '@ngxs/store';\nimport { SessionSetLanguage } from '../actions/session.actions';\nimport { Session } from '../models/session';\n\n@State<Session.State>({\n  name: 'SessionState',\n  defaults: {} as Session.State,\n})\nexport class SessionState {\n  @Selector()\n  static getLanguage({ language }: Session.State): string {\n    return language;\n  }\n\n  constructor() {}\n\n  @Action(SessionSetLanguage)\n  sessionSetLanguage({ patchState }: StateContext<Session.State>, { payload }: SessionSetLanguage) {\n    patchState({\n      language: payload,\n    });\n  }\n}\n","import { ABP } from '../models';\n\nexport function organizeRoutes(\n  routes: ABP.FullRoute[],\n  wrappers: ABP.FullRoute[] = [],\n  parentNameArr = [] as ABP.FullRoute[],\n  parentName: string = null,\n): ABP.FullRoute[] {\n  const filter = route => {\n    if (route.children) {\n      route.children = organizeRoutes(route.children, wrappers, parentNameArr, route.name);\n    }\n\n    if (route.parentName && route.parentName !== parentName) {\n      parentNameArr.push(route);\n      return false;\n    }\n\n    return true;\n  };\n\n  if (parentName) {\n    // recursive block\n    return routes.filter(filter);\n  }\n\n  const filteredRoutes = routes.filter(filter);\n\n  if (parentNameArr.length) {\n    return sortRoutes(setChildRoute([...filteredRoutes, ...wrappers], parentNameArr));\n  }\n\n  return filteredRoutes;\n}\n\nexport function setChildRoute(routes: ABP.FullRoute[], parentNameArr: ABP.FullRoute[]): ABP.FullRoute[] {\n  return routes\n    .map(route => {\n      if (route.children && route.children.length) {\n        route.children = setChildRoute(route.children, parentNameArr);\n      }\n\n      const foundedChildren = parentNameArr.filter(parent => parent.parentName === route.name);\n      if (foundedChildren && foundedChildren.length) {\n        route.children = [...(route.children || []), ...foundedChildren];\n      }\n\n      return route;\n    })\n    .filter(route => route.path || (route.children && route.children.length));\n}\n\nexport function sortRoutes(routes: ABP.FullRoute[] = []): ABP.FullRoute[] {\n  if (!routes.length) return [];\n  return routes\n    .sort((a, b) => a.order - b.order)\n    .map(route => {\n      if (route.children && route.children.length) {\n        route.children = sortRoutes(route.children);\n      }\n\n      return route;\n    });\n}\n","import { State, Selector, createSelector, Action, StateContext, Store } from '@ngxs/store';\nimport { Config, ABP } from '../models';\nimport { ConfigGetAppConfiguration, PatchRouteByName } from '../actions/config.actions';\nimport { ApplicationConfigurationService } from '../services/application-configuration.service';\nimport { tap, switchMap } from 'rxjs/operators';\nimport snq from 'snq';\nimport { SessionSetLanguage } from '../actions';\nimport { SessionState } from './session.state';\nimport { of } from 'rxjs';\nimport { setChildRoute, sortRoutes, organizeRoutes } from '../utils/route-utils';\n\n@State<Config.State>({\n  name: 'ConfigState',\n  defaults: {} as Config.State,\n})\nexport class ConfigState {\n  @Selector()\n  static getAll(state: Config.State) {\n    return state;\n  }\n\n  static getOne(key: string) {\n    const selector = createSelector(\n      [ConfigState],\n      function(state: Config.State) {\n        return state[key];\n      },\n    );\n\n    return selector;\n  }\n\n  static getDeep(keys: string[] | string) {\n    if (typeof keys === 'string') {\n      keys = keys.split('.');\n    }\n\n    if (!Array.isArray(keys)) {\n      throw new Error('The argument must be a dot string or an string array.');\n    }\n\n    const selector = createSelector(\n      [ConfigState],\n      function(state: Config.State) {\n        return (keys as string[]).reduce((acc, val) => {\n          if (acc) {\n            return acc[val];\n          }\n\n          return undefined;\n        }, state);\n      },\n    );\n\n    return selector;\n  }\n\n  static getApiUrl(key?: string) {\n    const selector = createSelector(\n      [ConfigState],\n      function(state: Config.State): string {\n        return state.environment.apis[key || 'default'].url;\n      },\n    );\n\n    return selector;\n  }\n\n  static getSetting(key: string) {\n    const selector = createSelector(\n      [ConfigState],\n      function(state: Config.State) {\n        return snq(() => state.setting.values[key]);\n      },\n    );\n\n    return selector;\n  }\n\n  static getGrantedPolicy(condition: string = '') {\n    const keys = condition\n      .replace(/\\(|\\)|\\!|\\s/g, '')\n      .split(/\\|\\||&&/)\n      .filter(key => key);\n\n    const selector = createSelector(\n      [ConfigState],\n      function(state: Config.State): boolean {\n        if (!keys.length) return true;\n\n        const getPolicy = key => snq(() => state.auth.grantedPolicies[key], false);\n        if (keys.length > 1) {\n          keys.forEach(key => {\n            const value = getPolicy(key);\n            condition = condition.replace(key, value);\n          });\n\n          // tslint:disable-next-line: no-eval\n          return eval(`!!${condition}`);\n        }\n\n        return getPolicy(condition);\n      },\n    );\n\n    return selector;\n  }\n\n  static getCopy(key: string, ...interpolateParams: string[]) {\n    if (!key) key = '';\n\n    const keys = key.split('::') as string[];\n    const selector = createSelector(\n      [ConfigState],\n      function(state: Config.State) {\n        const { defaultResourceName } = state.environment.localization;\n        if (keys[0] === '') {\n          if (!defaultResourceName) {\n            throw new Error(\n              `Please check your environment. May you forget set defaultResourceName? \n              Here is the example:\n               { production: false,\n                 localization: {\n                   defaultResourceName: 'MyProjectName'\n                  }\n               }`,\n            );\n          }\n\n          keys[0] = snq(() => defaultResourceName);\n        }\n\n        let copy = keys.reduce((acc, val) => {\n          if (acc) {\n            return acc[val];\n          }\n\n          return undefined;\n        }, state.localization.values);\n\n        if (copy && interpolateParams && interpolateParams.length) {\n          interpolateParams.forEach((param, index) => {\n            copy = copy.replace(`'{${index}}'`, param);\n          });\n        }\n\n        return copy || key;\n      },\n    );\n\n    return selector;\n  }\n\n  constructor(private appConfigurationService: ApplicationConfigurationService, private store: Store) {}\n\n  @Action(ConfigGetAppConfiguration)\n  addData({ patchState, dispatch }: StateContext<Config.State>) {\n    return this.appConfigurationService.getConfiguration().pipe(\n      tap(configuration =>\n        patchState({\n          ...configuration,\n        }),\n      ),\n      switchMap(configuration =>\n        this.store.selectSnapshot(SessionState.getLanguage)\n          ? of(null)\n          : dispatch(\n              new SessionSetLanguage(snq(() => configuration.setting.values['Abp.Localization.DefaultLanguage'])),\n            ),\n      ),\n    );\n  }\n\n  @Action(PatchRouteByName)\n  patchRoute({ patchState, getState }: StateContext<Config.State>, { name, newValue }: PatchRouteByName) {\n    let routes: ABP.FullRoute[] = getState().routes;\n\n    const index = routes.findIndex(route => route.name === name);\n\n    routes = patchRouteDeep(routes, name, newValue);\n\n    return patchState({\n      routes,\n    });\n  }\n}\n\nfunction patchRouteDeep(\n  routes: ABP.FullRoute[],\n  name: string,\n  newValue: Partial<ABP.FullRoute>,\n  parentUrl: string = null,\n): ABP.FullRoute[] {\n  routes = routes.map(route => {\n    if (route.name === name) {\n      if (newValue.path) {\n        newValue.url = `${parentUrl}/${newValue.path}`;\n      }\n\n      if (newValue.children && newValue.children.length) {\n        newValue.children = newValue.children.map(child => ({\n          ...child,\n          url: `${parentUrl}/${route.path}/${child.path}`,\n        }));\n      }\n\n      return { ...route, ...newValue };\n    } else if (route.children && route.children.length) {\n      route.children = patchRouteDeep(route.children, name, newValue, (parentUrl || '/') + route.path);\n    }\n\n    return route;\n  });\n\n  if (parentUrl) {\n    // recursive block\n    return routes;\n  }\n\n  return organizeRoutes(routes);\n}\n","export function uuid(a?: any): string {\n  return a\n    ? (a ^ ((Math.random() * 16) >> (a / 4))).toString(16)\n    : ('' + 1e7 + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, uuid);\n}\n","import { Injector } from '@angular/core';\nimport { Store } from '@ngxs/store';\nimport { ConfigGetAppConfiguration } from '../actions/config.actions';\n\nexport function getInitialData(injector: Injector) {\n  const fn = function() {\n    const store: Store = injector.get(Store);\n\n    return store.dispatch(new ConfigGetAppConfiguration()).toPromise();\n  };\n\n  return fn;\n}\n","import { Observable, Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n\nfunction isFunction(value) {\n  return typeof value === 'function';\n}\n\nexport const takeUntilDestroy = (componentInstance, destroyMethodName = 'ngOnDestroy') => <T>(\n  source: Observable<T>,\n) => {\n  const originalDestroy = componentInstance[destroyMethodName];\n  if (isFunction(originalDestroy) === false) {\n    throw new Error(\n      `${componentInstance.constructor.name} is using untilDestroyed but doesn't implement ${destroyMethodName}`,\n    );\n  }\n  if (!componentInstance['__takeUntilDestroy']) {\n    componentInstance['__takeUntilDestroy'] = new Subject();\n\n    componentInstance[destroyMethodName] = function() {\n      isFunction(originalDestroy) && originalDestroy.apply(this, arguments);\n      componentInstance['__takeUntilDestroy'].next(true);\n      componentInstance['__takeUntilDestroy'].complete();\n    };\n  }\n  return source.pipe(takeUntil<T>(componentInstance['__takeUntilDestroy']));\n};\n","import { Component, OnDestroy, Type } from '@angular/core';\nimport { NavigationEnd, Router, UrlSegment } from '@angular/router';\nimport { Select, Store } from '@ngxs/store';\nimport { Observable } from 'rxjs';\nimport { eLayoutType } from '../enums';\nimport { ABP, Config } from '../models';\nimport { ConfigState } from '../states';\nimport { takeUntilDestroy } from '../utils';\nimport snq from 'snq';\n\n@Component({\n  selector: 'abp-dynamic-layout',\n  template: `\n    <ng-container *ngTemplateOutlet=\"layout ? componentOutlet : routerOutlet\"></ng-container>\n\n    <ng-template #routerOutlet><router-outlet></router-outlet></ng-template>\n    <ng-template #componentOutlet><ng-container *ngComponentOutlet=\"layout\"></ng-container></ng-template>\n  `,\n})\nexport class DynamicLayoutComponent implements OnDestroy {\n  @Select(ConfigState.getOne('requirements'))\n  requirements$: Observable<Config.Requirements>;\n\n  layout: Type<any>;\n\n  constructor(private router: Router, private store: Store) {\n    this.router.events.pipe(takeUntilDestroy(this)).subscribe(event => {\n      if (event instanceof NavigationEnd) {\n        const { segments } = this.router.parseUrl(event.url).root.children.primary;\n        const {\n          requirements: { layouts },\n          routes,\n        } = this.store.selectSnapshot(ConfigState.getAll);\n\n        const layout = findLayout(segments, routes);\n\n        this.layout = layouts.filter(l => !!l).find(l => snq(() => l.type.toLowerCase().indexOf(layout), -1) > -1);\n      }\n    });\n  }\n\n  ngOnDestroy() {}\n}\n\nfunction findLayout(segments: UrlSegment[], routes: ABP.FullRoute[]): eLayoutType {\n  let layout = eLayoutType.empty;\n\n  const route = routes\n    .reduce((acc, val) => (val.wrapper ? [...acc, ...val.children] : [...acc, val]), [])\n    .find(r => r.path === segments[0].path);\n\n  if (route) {\n    if (route.layout) {\n      layout = route.layout;\n    }\n\n    if (route.children && route.children.length) {\n      const child = route.children.find(c => c.path === segments[1].path);\n\n      if (child.layout) {\n        layout = child.layout;\n      }\n    }\n  }\n\n  return layout;\n}\n","import { Component } from '@angular/core';\n\n@Component({\n  selector: 'abp-router-outlet',\n  template: `\n    <router-outlet></router-outlet>\n  `,\n})\nexport class RouterOutletComponent {}\n","import { AfterContentInit, ChangeDetectorRef, Directive, ElementRef, HostBinding, Input } from '@angular/core';\n\n@Directive({\n  selector: '[abpEllipsis]',\n})\nexport class EllipsisDirective implements AfterContentInit {\n  @Input('abpEllipsis')\n  witdh: string;\n\n  @HostBinding('title')\n  @Input()\n  title: string;\n\n  @Input('abpEllipsisEnabled')\n  enabled = true;\n\n  @HostBinding('class.abp-ellipsis')\n  get class() {\n    return this.enabled;\n  }\n\n  @HostBinding('style.max-width')\n  get maxWidth() {\n    return this.enabled ? this.witdh || '180px' : undefined;\n  }\n\n  constructor(private cdRef: ChangeDetectorRef, private elRef: ElementRef) {}\n\n  ngAfterContentInit() {\n    setTimeout(() => {\n      const title = this.title;\n      this.title = title || (this.elRef.nativeElement as HTMLElement).innerText;\n\n      if (this.title !== title) {\n        this.cdRef.detectChanges();\n      }\n    }, 0);\n  }\n}\n","import { Directive, ElementRef, Input, OnDestroy, OnInit, Optional, Renderer2 } from '@angular/core';\nimport { Store } from '@ngxs/store';\nimport { ConfigState } from '../states';\nimport { takeUntilDestroy } from '../utils';\n\n@Directive({\n  selector: '[abpPermission]',\n})\nexport class PermissionDirective implements OnInit, OnDestroy {\n  @Input('abpPermission') condition: string;\n\n  constructor(@Optional() private elRef: ElementRef, private renderer: Renderer2, private store: Store) {}\n\n  ngOnInit() {\n    if (this.condition) {\n      this.store\n        .select(ConfigState.getGrantedPolicy(this.condition))\n        .pipe(takeUntilDestroy(this))\n        .subscribe(isGranted => {\n          if (!isGranted) {\n            this.renderer.removeChild(\n              (this.elRef.nativeElement as HTMLElement).parentElement,\n              this.elRef.nativeElement,\n            );\n          }\n        });\n    }\n  }\n\n  ngOnDestroy(): void {}\n}\n","import { Directive, Input, Optional, ElementRef, Renderer2, AfterViewInit } from '@angular/core';\nimport { Subject } from 'rxjs';\nimport snq from 'snq';\n\n@Directive({\n  selector: '[abpVisibility]',\n})\nexport class VisibilityDirective implements AfterViewInit {\n  @Input('abpVisibility')\n  focusedElement: HTMLElement;\n\n  completed$ = new Subject<boolean>();\n\n  constructor(@Optional() private elRef: ElementRef, private renderer: Renderer2) {}\n\n  ngAfterViewInit() {\n    const observer = new MutationObserver(mutations => {\n      mutations.forEach(mutation => {\n        if (!mutation.target) return;\n\n        const htmlNodes = snq(\n          () => Array.from(mutation.target.childNodes).filter(node => node instanceof HTMLElement),\n          [],\n        );\n\n        if (!htmlNodes.length) {\n          this.renderer.removeChild(this.elRef.nativeElement.parentElement, this.elRef.nativeElement);\n          this.disconnect();\n        } else {\n          setTimeout(() => {\n            this.disconnect();\n          }, 0);\n        }\n      });\n    });\n\n    observer.observe(this.focusedElement, {\n      childList: true,\n    });\n\n    this.completed$.subscribe(() => observer.disconnect());\n  }\n\n  disconnect() {\n    this.completed$.next();\n    this.completed$.complete();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ActivatedRouteSnapshot, CanActivate, RouterStateSnapshot, UrlTree } from '@angular/router';\nimport { Store } from '@ngxs/store';\nimport { OAuthService } from 'angular-oauth2-oidc';\nimport { Observable } from 'rxjs';\nimport { Navigate } from '@ngxs/router-plugin';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AuthGuard implements CanActivate {\n  constructor(private oauthService: OAuthService, private store: Store) {}\n  canActivate(_: ActivatedRouteSnapshot, state: RouterStateSnapshot): Observable<boolean> | boolean | UrlTree {\n    const hasValidAccessToken = this.oauthService.hasValidAccessToken();\n    if (hasValidAccessToken) {\n      return hasValidAccessToken;\n    }\n\n    this.store.dispatch(new Navigate(['/account/login'], null, { state: { redirectUrl: state.url } }));\n\n    return false;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ActivatedRouteSnapshot, CanActivate } from '@angular/router';\nimport { Store } from '@ngxs/store';\nimport { Observable } from 'rxjs';\nimport { ConfigState } from '../states';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class PermissionGuard implements CanActivate {\n  constructor(private store: Store) {}\n\n  canActivate({ data }: ActivatedRouteSnapshot): Observable<boolean> {\n    const resource = data.requiredPolicy as string;\n    return this.store.select(ConfigState.getGrantedPolicy(resource));\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpInterceptor, HttpHandler, HttpRequest } from '@angular/common/http';\nimport { OAuthService } from 'angular-oauth2-oidc';\nimport { Store } from '@ngxs/store';\nimport { SessionState } from '../states';\nimport { LoaderStart, LoaderStop } from '../actions/loader.actions';\nimport { finalize } from 'rxjs/operators';\n\n@Injectable()\nexport class ApiInterceptor implements HttpInterceptor {\n  constructor(private oAuthService: OAuthService, private store: Store) {}\n\n  intercept(request: HttpRequest<any>, next: HttpHandler) {\n    this.store.dispatch(new LoaderStart(request));\n\n    const headers = {} as any;\n\n    const token = this.oAuthService.getAccessToken();\n    if (!request.headers.has('Authorization') && token) {\n      headers['Authorization'] = `Bearer ${token}`;\n    }\n\n    const lang = this.store.selectSnapshot(SessionState.getLanguage);\n    if (!request.headers.has('Accept-Language') && lang) {\n      headers['Accept-Language'] = lang;\n    }\n\n    return next\n      .handle(\n        request.clone({\n          setHeaders: headers,\n        }),\n      )\n      .pipe(finalize(() => this.store.dispatch(new LoaderStop(request))));\n  }\n}\n","import { HttpHeaders, HttpParams } from '@angular/common/http';\n\nexport namespace Rest {\n  export interface Config {\n    throwErr?: boolean;\n    observe?: Observe;\n  }\n\n  export const enum Observe {\n    Body = 'body',\n    Events = 'events',\n    Response = 'response',\n  }\n\n  export const enum ResponseType {\n    ArrayBuffer = 'arraybuffer',\n    Blob = 'blob',\n    JSON = 'json',\n    Text = 'text',\n  }\n\n  export interface Request<T> {\n    body?: T;\n    headers?:\n      | HttpHeaders\n      | {\n          [header: string]: string | string[];\n        };\n    method: string;\n    params?:\n      | HttpParams\n      | {\n          [param: string]: any;\n        };\n    reportProgress?: boolean;\n    responseType?: ResponseType;\n    url: string;\n    withCredentials?: boolean;\n  }\n}\n","import { Injectable, Inject, InjectionToken, Type } from '@angular/core';\nimport { NgxsPlugin, setValue, actionMatcher, InitState, UpdateState, NgxsNextPluginFn } from '@ngxs/store';\nimport { Router, Routes } from '@angular/router';\nimport { ABP } from '../models';\nimport snq from 'snq';\nimport { setChildRoute, sortRoutes, organizeRoutes } from '../utils/route-utils';\n\nexport const NGXS_CONFIG_PLUGIN_OPTIONS = new InjectionToken('NGXS_CONFIG_PLUGIN_OPTIONS');\n\n@Injectable()\nexport class ConfigPlugin implements NgxsPlugin {\n  private initialized: boolean = false;\n\n  constructor(@Inject(NGXS_CONFIG_PLUGIN_OPTIONS) private options: ABP.Root, private router: Router) {}\n\n  handle(state: any, event: any, next: NgxsNextPluginFn) {\n    const matches = actionMatcher(event);\n    const isInitAction = matches(InitState) || matches(UpdateState);\n\n    // const layouts = snq(() => this.options.requirements.layouts.filter(layout => layout instanceof Type), []);\n    if (isInitAction && !this.initialized) {\n      let { routes, wrappers } = transformRoutes(this.router.config);\n      routes = organizeRoutes(routes, wrappers);\n\n      state = setValue(state, 'ConfigState', {\n        ...(state.ConfigState && { ...state.ConfigState }),\n        ...this.options,\n        routes,\n      });\n\n      this.initialized = true;\n    }\n\n    return next(state, event);\n  }\n}\n\nfunction transformRoutes(routes: Routes = [], wrappers: ABP.FullRoute[] = []): any {\n  const abpRoutes: ABP.FullRoute[] = routes\n    .filter(route => {\n      return snq(() => route.data.routes.find(r => r.path === route.path), false);\n    })\n    .reduce((acc, val) => [...acc, ...val.data.routes], []);\n\n  wrappers = abpRoutes.filter(ar => ar.wrapper);\n  const transformed = [] as ABP.FullRoute[];\n  routes\n    .filter(route => route.component || route.loadChildren)\n    .forEach(route => {\n      const abpPackage = abpRoutes.find(abp => abp.path.toLowerCase() === route.path.toLowerCase());\n      const { length } = transformed;\n\n      if (abpPackage) {\n        transformed.push(abpPackage);\n      }\n\n      if (transformed.length === length) {\n        transformed.push({\n          path: route.path,\n          name: snq(() => route.data.routes.name, route.path),\n          children: route.data.routes.children || [],\n        } as ABP.FullRoute);\n      }\n    });\n\n  return { routes: setUrls(transformed), wrappers };\n}\n\nfunction setUrls(routes: ABP.FullRoute[], parentUrl?: string): ABP.FullRoute[] {\n  if (parentUrl) {\n    // this if block using for only recursive call\n\n    return routes.map(route => ({\n      ...route,\n      url: `${parentUrl}/${route.path}`,\n      ...(route.children &&\n        route.children.length && {\n          children: setUrls(route.children, `${parentUrl}/${route.path}`),\n        }),\n    }));\n  }\n\n  return routes.map(route => ({\n    ...route,\n    url: `/${route.path}`,\n    ...(route.children &&\n      route.children.length && {\n        children: setUrls(route.children, `/${route.path}`),\n      }),\n  }));\n}\n","import { Injectable } from '@angular/core';\nimport { Store } from '@ngxs/store';\nimport { ConfigState } from '../states';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ConfigService {\n  constructor(private store: Store) {}\n\n  getAll() {\n    return this.store.selectSnapshot(ConfigState.getAll);\n  }\n\n  getOne(key: string) {\n    return this.store.selectSnapshot(ConfigState.getOne(key));\n  }\n\n  getDeep(keys: string[] | string) {\n    return this.store.selectSnapshot(ConfigState.getDeep(keys));\n  }\n\n  getSetting(key: string) {\n    return this.store.selectSnapshot(ConfigState.getSetting(key));\n  }\n}\n","import { Inject, Injectable } from '@angular/core';\nimport { Observable, ReplaySubject } from 'rxjs';\nimport { uuid } from '../utils';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class LazyLoadService {\n  loadedLibraries: { [url: string]: ReplaySubject<void> } = {};\n\n  load(\n    url: string,\n    type: 'script' | 'style',\n    content: string = '',\n    targetQuery: string = 'body',\n    position: InsertPosition = 'afterend',\n  ): Observable<void> {\n    if (!url && !content) return;\n    const key = url ? url.slice(url.lastIndexOf('/') + 1) : uuid();\n\n    if (this.loadedLibraries[key]) {\n      return this.loadedLibraries[key].asObservable();\n    }\n\n    this.loadedLibraries[key] = new ReplaySubject();\n\n    let library;\n    if (type === 'script') {\n      library = document.createElement('script');\n      library.type = 'text/javascript';\n      if (url) {\n        (library as HTMLScriptElement).src = url;\n      }\n\n      (library as HTMLScriptElement).text = content;\n    } else if (url) {\n      library = document.createElement('link');\n      library.type = 'text/css';\n      (library as HTMLLinkElement).rel = 'stylesheet';\n\n      if (url) {\n        (library as HTMLLinkElement).href = url;\n      }\n    } else {\n      library = document.createElement('style');\n      (library as HTMLStyleElement).textContent = content;\n    }\n\n    library.onload = () => {\n      this.loadedLibraries[key].next();\n      this.loadedLibraries[key].complete();\n    };\n\n    document.querySelector(targetQuery).insertAdjacentElement(position, library);\n\n    return this.loadedLibraries[key].asObservable();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Store } from '@ngxs/store';\nimport { ConfigState } from '../states';\nimport { Observable } from 'rxjs';\n\n@Injectable({ providedIn: 'root' })\nexport class LocalizationService {\n  constructor(private store: Store) {}\n\n  get(keys: string, ...interpolateParams: string[]): Observable<string> {\n    return this.store.select(ConfigState.getCopy(keys, ...interpolateParams));\n  }\n\n  instant(keys: string, ...interpolateParams: string[]): string {\n    return this.store.selectSnapshot(ConfigState.getCopy(keys, ...interpolateParams));\n  }\n}\n","import { InjectionToken } from '@angular/core';\nimport { Config } from '../models';\n\nexport function environmentFactory(environment: Config.Environment) {\n  return {\n    ...environment,\n  };\n}\n\nexport function configFactory(config: Config.Requirements) {\n  return {\n    ...config,\n  };\n}\n\nexport const ENVIRONMENT = new InjectionToken('ENVIRONMENT');\n\nexport const CONFIG = new InjectionToken('CONFIG');\n","import { Pipe, PipeTransform, OnDestroy } from '@angular/core';\nimport { Store } from '@ngxs/store';\nimport { ConfigState } from '../states';\nimport { takeUntilDestroy } from '../utils';\nimport { distinctUntilChanged } from 'rxjs/operators';\n\n@Pipe({\n  name: 'abpLocalization',\n  pure: false, // required to update the value\n})\nexport class LocalizationPipe implements PipeTransform, OnDestroy {\n  initialized: boolean = false;\n\n  value: string;\n\n  constructor(private store: Store) {}\n\n  transform(value: string, ...interpolateParams: string[]): string {\n    if (!this.initialized) {\n      this.initialized = true;\n\n      this.store\n        .select(\n          ConfigState.getCopy(\n            value,\n            ...interpolateParams.reduce((acc, val) => (Array.isArray(val) ? [...acc, ...val] : [...acc, val]), []),\n          ),\n        )\n        .pipe(\n          takeUntilDestroy(this),\n          distinctUntilChanged(),\n        )\n        .subscribe(copy => (this.value = copy));\n    }\n\n    return this.value;\n  }\n\n  ngOnDestroy() {}\n}\n","import { CommonModule } from '@angular/common';\nimport { HttpClientModule, HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { APP_INITIALIZER, Injector, ModuleWithProviders, NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { RouterModule } from '@angular/router';\nimport { NgxsRouterPluginModule } from '@ngxs/router-plugin';\nimport { NgxsStoragePluginModule } from '@ngxs/storage-plugin';\nimport { NgxsModule, NGXS_PLUGINS } from '@ngxs/store';\nimport { DynamicLayoutComponent } from './components/dynamic-layout.component';\nimport { RouterOutletComponent } from './components/router-outlet.component';\nimport { PermissionDirective } from './directives/permission.directive';\nimport { VisibilityDirective } from './directives/visibility.directive';\nimport { ApiInterceptor } from './interceptors/api.interceptor';\nimport { ABP } from './models/common';\nimport { LocalizationPipe } from './pipes/localization.pipe';\nimport { ConfigPlugin, NGXS_CONFIG_PLUGIN_OPTIONS } from './plugins/config.plugin';\nimport { ConfigState } from './states/config.state';\nimport { ProfileState } from './states/profile.state';\nimport { SessionState } from './states/session.state';\nimport { getInitialData } from './utils/initial-utils';\nimport { EllipsisDirective } from './directives/ellipsis.directive';\n\n@NgModule({\n  imports: [\n    NgxsModule.forFeature([ProfileState, SessionState, ConfigState]),\n    NgxsStoragePluginModule.forRoot({ key: 'SessionState' }),\n    NgxsRouterPluginModule.forRoot(),\n    CommonModule,\n    HttpClientModule,\n    FormsModule,\n    ReactiveFormsModule,\n    RouterModule,\n  ],\n  declarations: [\n    RouterOutletComponent,\n    DynamicLayoutComponent,\n    PermissionDirective,\n    VisibilityDirective,\n    LocalizationPipe,\n    EllipsisDirective,\n  ],\n  exports: [\n    CommonModule,\n    HttpClientModule,\n    FormsModule,\n    ReactiveFormsModule,\n    RouterModule,\n    RouterOutletComponent,\n    DynamicLayoutComponent,\n    PermissionDirective,\n    VisibilityDirective,\n    EllipsisDirective,\n    LocalizationPipe,\n  ],\n  providers: [LocalizationPipe],\n  entryComponents: [RouterOutletComponent, DynamicLayoutComponent],\n})\nexport class CoreModule {\n  static forRoot(options = {} as ABP.Root): ModuleWithProviders {\n    return {\n      ngModule: CoreModule,\n      providers: [\n        {\n          provide: NGXS_PLUGINS,\n          useClass: ConfigPlugin,\n          multi: true,\n        },\n        {\n          provide: NGXS_CONFIG_PLUGIN_OPTIONS,\n          useValue: options,\n        },\n        {\n          provide: HTTP_INTERCEPTORS,\n          useClass: ApiInterceptor,\n          multi: true,\n        },\n        {\n          provide: APP_INITIALIZER,\n          multi: true,\n          deps: [Injector],\n          useFactory: getInitialData,\n        },\n      ],\n    };\n  }\n}\n"]}